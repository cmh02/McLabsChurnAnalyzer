# MCLabs Churn Analyzer: Gathering Skripts

This directory contains a number of [skripts](https://github.com/SkriptLang/Skript) that are used to extract player data from the server via a variety of methods. The various types of data sources that exist on the server are explained further in the general [README](../README.md).  Note that some gathering skripts or other skript utilities that are used by the gathering skripts shown here are not provided in order to maintain the scope of this project and prevent revealing some of the larger architecture, player data, and information systems that are present on the server. For more information, see [Missing Skript Resources](#missing-skript-resources).

## A (Brief) Introduction to Skript

If you are coming from a non-minecraft-server-development background, you are likely unfamiliar with [Skript](https://github.com/SkriptLang/Skript). Skript is a popular choice among server developers for creating custom commands, features, and systems on minecraft servers without handling full-on Java plugin development. It allows for quicker development times, easier maintenance, and faster deployment. It provides easy-to-use syntax for scripting that is often simpler than even Python, providing direct references to minecraft-related elements common in the systems developed.

Because of the simplicity provided by Skript, most of the code is relatively easy to follow and prior knowledge of most syntax is not needed. However, one area that is likely to be confusing is the combination of Java code. One of Skript's addons - [skript-reflect](https://tpgamesnl.gitbook.io/skript-reflect) - allows for Java code to be directly added into skripts. This allows us to extend beyond skript's basic functionality and work directly with other plugins on the server via API's and databases. When implemented, this looks like a thrown-together combination of skript syntax and Java syntax, and can be a bit confusing at times.

To save those unfamiliar with Skript, or further unfamiliar with skript-reflect, time from trying to understand the syntax, the code is thoroughly explained with comments in all of the skripts provided here. Additionally, these skripts would likely have to be modified or adjusted for use in server environments other than the one present on MCLabs - our configuration of skript versions, skript addons, other skript modules we have developed, plugins, databases, etc. are likely different than other environments and therefore these skripts are not universal implementations. However, the approaches taken here are common to most server environments and should seem fairly straightforward to follow.

## Provided Gathering Skripts

| Skript File Name                                  | Data Gathered                                                                                                          | Approach and Implementation                                                                                                                                                                                                                     |
| ------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| [gathering.sk](gathering.sk)                         | None                                                                                                                   | This is a master-control and utility skript. It contains several functions for a variety of outputs along with essential functions to individual gathering skripts.                                                                             |
| [gathering-balance.sk](gathering-balance.sk)         | Economy Balances                                                                                                       | This skript gathers all players' balance data using built-in[skript syntax for economy access](https://skripthub.net/docs/?id=920).                                                                                                                |
| [gathering-plan.sk](gathering-plan.sk)               | Playtimes<br />ActiveTime<br />AFKTime<br />Last Seen Date<br />Favorite Server                                        | This skript gathers all players'[Plan Player Analytics](https://github.com/plan-player-analytics/Plan) data using placeholders provided by Plan through [PlaceholderAPI](https://github.com/PlaceholderAPI/PlaceholderAPI/wiki/Placeholders) (PAPI)). |
| [gathering-mcmmo.sk](gathering-mcmmo.sk)             | MCMMO Power Level<br />MCMMO Skill Levels                                                                              | This skript gathers all players' MCMMO data using the[MCMMO Java API ](https://github.com/mcMMO-Dev/mcMMO/tree/master/src/main/java/com/gmail/nossr50/api)(DatabaseAPI, ExperienceAPI, SkillAPI)).                                                 |
| [gathering-leaderboard.sk](gathering-leaderboard.sk) | All-Time Chem Leaderboard<br />All-Time Police Leaderboard<br />Weekly Chem Leaderboard<br />Weekly Police Leaderboard | This skript gathers all players' weekly and all-time positions on the chem and police leaderboards.                                                                                                                                             |
| [gathering-ranks.sk](gathering-ranks.sk)             | Chem Rank Weight<br />Police Rank Weight<br />Door Rank Weight                                                         | This skript gathers all players' chem ranks, police ranks, and donor ranks. Ranks are represented by a weighted value, with a higher weight representing a higher rank.                                                                         |

## Missing Skript Resources

`gathering.sk`: One resource missing from the provided gathering skripts is our `centraloutput `interface that defines common outputs such as server console, log files, discord, developers, players, etc. You can see the signature of several `centraloutput` utility functions in [gathering.sk](gathering.sk), where they are wrapped in gathering-specific utility functions that pre-define some of the needed arguments.

`gathering-leaderboard.sk`: This skript utilizes a function that is provided by our internal leaderboard system, which is also built using Skript. The implementation of this is very similar to an API call - we simply provide a player, a leaderboard type, and a time span to the function call and receive a leaderboard position back.
